Title: Dissecting Kimsuky’s Attacks on South Korea: In-Depth Analysis of GitHub-Based Malicious Infrastructure; Author: N/A; Date: N/A; Source: N/A; Group: Kimsuky; Family: XenoRAT
Summary: Used hardcoded GitHub PATs and Dropbox to deliver XenoRAT and exfiltrate victim logs to private repos.
Key:
    1) Hardcoded GitHub PAT (repo scope) used to download/upload malware and victim logs.
    2) XenoRAT samples/GUID and C&C 158.247.202[.]109 plus test IP 80.71.157[.]55 link activity to Kimsuky; spearphishing, scheduled tasks and keylogging observed.

Behavior Flow:
1) Kimsuky launch spearphishing email — sent from 158.247.253[.]215 to lure victim into opening attachment
2) powershell.exe http_request https://dl.dropboxusercontent[.]com/scl/fi/c6ba7iwuke57d75j3mmte/eula.rtf$dropboxBaseUrl?rlkey=t0jnirhxk48xdu8p74rqgv9dw&st=oofgjsq8&dl=0 — download .rtf from Dropbox
3) powershell.exe create eula.rtf — save downloaded .rtf (eula.rtf)
4) powershell.exe modify eula.rtf — overwrite first seven bytes with GZIP header
5) powershell.exe decompress eula.rtf — decompress GZIP to produce .NET executable
6) powershell.exe inject — in memory (execute decompressed .NET payload filelessly)
7) XenoRAT create mutex Dansweit_Hk65 — establish runtime mutex
8) XenoRAT network_connect 158.247.230[.]196:443 — connect to C&C server
9) powershell.exe http_request https://raw.githubusercontent[.]com/Dasi274/star/main/xxx.rtf — download xxx.rtf from private GitHub repository
10) powershell.exe create xxx.rtf — save downloaded xxx.rtf
11) powershell.exe http_request https://raw.githubusercontent[.]com/luckmask/asp/main/xxx.rtf — download xxx.rtf from alternate GitHub account
12) powershell.exe create xxx.rtf — save downloaded xxx.rtf (from luckmask)
13) powershell.exe write %AppData%\Microsoft\[ip]-[MMdd_HHmm]-0956_info.txt — record system information (boot time, OS, processes, etc.)
14) powershell.exe create %AppData%\[ip]-[MMdd_HHmm]-XXX-kkk.txt — create periodic infection log in %AppData%
15) powershell.exe write %AppData%\[ip]-[MMdd_HHmm]-XXX-kkk.txt — write last boot time to periodic infection log
16) powershell.exe persist scheduled task — register scheduled task to execute malware every 30 minutes
17) powershell.exe launch ofx.txt — execute ofx.txt via scheduled task every 30 minutes
18) powershell.exe exfiltrate [ip]-[MMdd_HHmm]-0956_info.txt — upload info file to Dasi274/hole_311/log using hardcoded GitHub PAT
19) XenoRAT write [ip]-[currentTime]-XXX-kkk-key.txt — record keylogging data (window titles, keystrokes, clipboard)
20) powershell.exe network_connect 101.36.114[.]190 — send requests to C&C server at 101.36.114[.]190
21) powershell.exe compress processlist.txt — compress collected process/system data into zip in memory
22) powershell.exe delete processlist.txt processlist.zip dose.vbs — remove artifacts from Temp directory
23) powershell.exe exfiltrate base64-encoded processlist.zip — upload encoded data to 101.36.114[.]190
24) Dasi274 modify ofx.txt — change ofx.txt in repository to RAT downloader (commit change)
25) Dasi274 create eula.rtf — upload eula.rtf to hole_311 repository as test/uploaded payload
26) XenoRAT network_connect 216.244.74[.]115:80 — connect to alternative C&C server
27) XenoRAT network_connect 165.154.78[.]9:443 — connect to alternative C&C server

MITRE ATT&CK Techniques:
1) T1566.001 — Phishing: Spearphishing Attachment
2) T1059.001 — Command and Scripting Interpreter: PowerShell
3) T1059.003 — Command and Scripting Interpreter: Windows Command Shell
4) T1059.007 — Command and Scripting Interpreter: JavaScript
5) T1204.002 — User Execution: Malicious File
6) T1053.005 — Persistence: Scheduled Task/Job (Scheduled Task)
7) T1027.010 — Defense Evasion: Obfuscated Files or Information (Command Obfuscation)
8) T1140 — Defense Evasion: Deobfuscate/Decode Files or Information
9) T1057 — Discovery: Process Discovery
10) T1082 — Discovery: System Information Discovery
11) T1115 — Collection: Clipboard Data
12) T1056.001 — Collection: Input Capture (Keylogging)
13) T1567.001 — Exfiltration Over Web Service: Exfiltration to Code Repository
14) T1567.002 — Exfiltration Over Web Service: Exfiltration to Cloud Storage
15) T1102 — Command and Control: Web Service
16) T1071 — Command and Control: Application Layer Protocol (Web Protocols)
17) T1571 — Command and Control: Non-Standard Port
18) T1132.001 — Command and Control: Data Encoding (Standard Encoding)
19) T1573.001 — Command and Control: Encrypted Channel (Symmetric Cryptography)